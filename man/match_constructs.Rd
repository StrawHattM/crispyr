% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/match_and_map.R
\name{match_constructs}
\alias{match_constructs}
\title{Match Extracted Barcodes to Reference Library}
\usage{
match_constructs(
  extracted_barcodes,
  reference_library,
  max_mismatches = 0,
  quiet = FALSE
)
}
\arguments{
\item{extracted_barcodes}{A data.table from \code{\link[=extract_barcodes_from_fastq]{extract_barcodes_from_fastq()}}.}

\item{reference_library}{A tibble/data.frame from \code{\link[=load_reference_library]{load_reference_library()}} with
columns \code{barcode} and \code{construct_id}.}

\item{max_mismatches}{Integer. Maximum number of mismatches allowed for a barcode match.
Default: 0 (exact matching only). Set >0 for approximate matching using Hamming distance.}

\item{quiet}{Logical. If \code{TRUE}, suppress progress messages. Default: \code{FALSE}.}
}
\value{
A \link[data.table:data.table]{data.table::data.table} with columns from the input plus:
\itemize{
\item \code{construct_id}: Mapped construct ID (NA if no match found)
\item \code{match_type}: Type of match ("exact", "mismatch_1bp", etc., or "no_match")
\item \code{match_quality}: Quality of the match (0-1 scale, with 1 being perfect)
}
}
\description{
Maps extracted construct barcodes to the reference library of known constructs.
Supports exact matching or approximate matching with a specified Hamming distance
tolerance.
}
\details{
\subsection{Matching Strategy}{
\enumerate{
\item \strong{Exact matching} (default, \code{max_mismatches = 0}):
Fast lookup using hash table. All extracted barcodes are checked against
the reference library.
\item \strong{Approximate matching} (\code{max_mismatches > 0}):
Slower but catches barcodes with sequencing errors. Uses Hamming distance
to find the closest matching barcode in the reference library.
}
}
}
\examples{
\dontrun{
  # Exact matching (fastest)
  matched <- match_constructs(
    extracted_barcodes,
    reference_library
  )

  # Allow up to 1 mismatch
  matched <- match_constructs(
    extracted_barcodes,
    reference_library,
    max_mismatches = 1
  )
}

}
