% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/count_and_normalize.R
\name{lognormalize_counts}
\alias{lognormalize_counts}
\title{Log-Normalize Counts}
\usage{
lognormalize_counts(
  count_matrix,
  method = c("poolq", "log2", "cpm"),
  quiet = FALSE
)
}
\arguments{
\item{count_matrix}{A numeric matrix with samples as columns and features
(constructs/genes) as rows.}

\item{method}{Character. Normalization method.
\itemize{
\item "poolq": PoolQ-style log2 normalization (default)
\item "log2": Simple log2(count + 1)
\item "cpm": Counts per million
}}

\item{quiet}{Logical. If \code{TRUE}, suppress progress messages. Default: \code{FALSE}.}
}
\value{
A numeric matrix with the same dimensions as input, containing
log-normalized counts.
}
\description{
Applies log-normalization to count matrices using the PoolQ method:
\code{log2((count + 1) / (median_count_per_sample + 1))}
}
\details{
This normalization accounts for differences in sequencing depth between samples
while avoiding log(0) by adding a pseudocount of 1.
\subsection{PoolQ Normalization Formula}{

For each sample, the median read count across all features is calculated.
Each feature's count in that sample is then normalized as:

\if{html}{\out{<div class="sourceCode">}}\preformatted{lognorm = log2((count + 1) / (median + 1))
}\if{html}{\out{</div>}}

This makes counts comparable across samples with different sequencing depths.
}
}
\examples{
\dontrun{
  # Create count matrix
  count_data <- create_count_matrix(aggregated_reads)

  # Normalize
  lognorm_matrix <- lognormalize_counts(count_data$matrix)
}

}
