% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/match_and_map.R
\name{map_constructs_to_genes}
\alias{map_constructs_to_genes}
\title{Map Constructs to Genes}
\usage{
map_constructs_to_genes(
  matched_barcodes,
  chip_file,
  annotation_type = "all",
  quiet = FALSE
)
}
\arguments{
\item{matched_barcodes}{A data.table from \code{\link[=match_constructs]{match_constructs()}} with construct mappings.}

\item{chip_file}{A tibble/data.frame from \code{\link[=load_chip_file]{load_chip_file()}} with columns
\code{barcode}, \code{gene_symbol}, and \code{gene_id}.}

\item{annotation_type}{Character. Type of annotation to select if multiple are available.
Default: "all" (keep all mappings). Other options: "strict", "lax", etc.}

\item{quiet}{Logical. If \code{TRUE}, suppress progress messages. Default: \code{FALSE}.}
}
\value{
A \link[data.table:data.table]{data.table::data.table} with input columns plus:
\itemize{
\item \code{gene_symbol}: Target gene symbol (NA if barcode has no gene annotation)
\item \code{gene_id}: Target gene ID (NA if barcode has no gene annotation)
\item \code{barcode_to_genes}: Number of genes mapped to this barcode
}
}
\description{
Maps construct barcodes to their target genes using a chip annotation file.
Note that one barcode can map to multiple genes (e.g., in lax matching).
}
\details{
\subsection{Gene Mapping Strategy}{

Each barcode is left-joined to the chip file. If a barcode maps to multiple genes
(common in lax chip files), each barcode-gene pair becomes a separate row.
This allows downstream analysis to keep guide-level information separate from
gene-level aggregation.
}
}
\examples{
\dontrun{
  # Map to genes
  with_genes <- map_constructs_to_genes(
    matched_barcodes,
    chip_file
  )

  # Check how many genes each barcode targets
  with_genes \%>\% distinct(barcode, gene_symbol) \%>\% count(barcode)
}

}
