% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extract_barcodes.R
\name{extract_barcodes_from_fastq}
\alias{extract_barcodes_from_fastq}
\title{Extract Construct and Sample Barcodes from FASTQ Files}
\usage{
extract_barcodes_from_fastq(
  fastq_files,
  barcode_policy = "PREFIX:CACCG@6",
  construct_barcode_length = 20,
  min_quality_score = NULL,
  quiet = FALSE
)
}
\arguments{
\item{fastq_files}{Character vector of paths to FASTQ files (gzip compressed or not).}

\item{barcode_policy}{Character string specifying barcode extraction policy.
Default: "PREFIX:CACCG@6" (Broad Institute standard).
Format: "PREFIX:SEQUENCE@POSITION"}

\item{construct_barcode_length}{Integer. Length of construct barcode in bp.
Default: 20 (standard for CRISPR guides).}

\item{min_quality_score}{Integer. Minimum mean quality score threshold.
If provided, reads below this threshold are filtered. Default: NULL (no filtering).}

\item{quiet}{Logical. If \code{TRUE}, suppress progress messages. Default: \code{FALSE}.}
}
\value{
A \link[data.table:data.table]{data.table::data.table} with columns:
\itemize{
\item \code{fastq_file}: Source FASTQ file name
\item \code{read_id}: Read identifier from FASTQ header
\item \code{construct_barcode}: Extracted 20bp construct barcode
\item \code{sample_barcode}: Extracted 8bp sample barcode (if found, else NA)
\item \code{extraction_status}: Status of barcode extraction
\itemize{
\item "success": Both barcodes extracted
\item "no_construct_flank": Flanking sequence not found
\item "construct_too_short": Read too short for barcode extraction
\item "no_sample_barcode": Construct extracted but sample barcode not parseable
}
}
}
\description{
Extracts construct (20bp) and sample (8bp) barcodes from FASTQ reads.
The construct barcode position is defined by a barcode policy specifying
a flanking sequence and position offset.
}
\details{
\subsection{Barcode Extraction Logic}{
\enumerate{
\item \strong{Construct barcode}: Searches for the flanking sequence (e.g., "CACCG") in the read.
Once found, extracts the specified number of bases (default 20) starting from the
position offset (e.g., position 6 after "CACCG").
\item \strong{Sample barcode}: Extracts the first 8bp of the read as the sample barcode.
This is based on PoolQ's dual-barcode design where the first 8bp identify the sample.
}
}
}
\examples{
\dontrun{
  # Extract from single FASTQ file
  barcodes <- extract_barcodes_from_fastq(
    "path/to/sample.fastq.gz"
  )

  # Extract from multiple files
  barcodes <- extract_barcodes_from_fastq(
    c("file1.fastq.gz", "file2.fastq.gz")
  )
}

}
